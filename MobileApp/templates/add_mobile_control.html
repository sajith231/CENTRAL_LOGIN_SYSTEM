{% extends 'base.html' %}
{% block content %}
<h2>Add Mobile Control</h2>

<form method="POST">
  {% csrf_token %}
  <div class="mb-3">
    <label>Project</label>
    <select name="project" class="form-control" required>
      <option value="">Select Project</option>
      {% for project in projects %}
        <option value="{{ project.id }}">{{ project.project_name }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-3">
    <label>Shop</label>
    <select id="shopSelect" name="shop" class="form-control" required>
      <option value="">Select Shop</option>
      {% for shop in shops %}
        <option value="{{ shop.id }}" data-client="{{ shop.client_id }}">{{ shop.name }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-3">
    <label>Client ID</label>
    <input type="text" id="clientIdInput" class="form-control" readonly>
  </div>

  <div class="mb-3">
    <label>Login Limit</label>
    <input type="number" name="login_limit" class="form-control" value="1" required>
  </div>

  <button type="submit" class="btn btn-success">Save</button>
</form>

<script>
document.getElementById("shopSelect").addEventListener("change", function() {
  const selectedOption = this.options[this.selectedIndex];
  const clientId = selectedOption.getAttribute("data-client") || "";
  document.getElementById("clientIdInput").value = clientId;
});
</script>

{% endblock %}
